<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AW Helpdesk Functions</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
<script>
  // Called by ExecuteFunction in the manifest
  function openPortal(event) {
    try {
      const url = "https://help.abelwomack.com";
      if (Office?.context?.ui?.openBrowserWindow) {
        Office.context.ui.openBrowserWindow(url);
      } else {
        window.open(url, "_blank");
      }
    } catch (e) {
      // swallow to avoid failing command
      console.log("openPortal error:", e);
    } finally {
      // Always complete the event for command functions
      if (event && typeof event.completed === "function") event.completed();
    }
  }

  // Expose to Office runtime
  Office.actions.associate("openPortal", openPortal);

  Office.onReady(() => {
    console.log("[AW] FunctionFile ready");
  });
</script>
</body>
</html>
